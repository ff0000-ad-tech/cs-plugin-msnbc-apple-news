<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta content="utf-8" http-equiv="encoding" />
	<title>_____ BANNER</title>
	<script type="text/javascript">
		window.addEventListener("resize", function() {//JM
			window.adParams.adWidth = window.innerWidth;
			window.adParams.adHeight = window.innerHeight;
		});

	</script>

	<style type="text/css">
		html,
		body,
		#view {
			width: 100%;
			height: 100%;
		}

		#view {
			overflow: hidden;
		}

		body {
			margin: 0px;
			outline: none;
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
		}
	</style>
	<style type="text/css" id="RED_uiBorder">
		.ui-border {
			position: absolute;
			top: 0px;
			left: 0px;
			width: 100%;
			height: 100%;
			border-width: 0px;
			border-style: solid;
			box-sizing: border-box;
			-moz-box-sizing: border-box;
			-webkit-box-sizing: border-box;
		}
	</style>
</head>

<body>
	<div id="view">
		<div id="main"></div>
		<div id="aux">
			<div id="preloader" class="ui-border"></div>
			<div id="fail"></div>
		</div>
	</div>
	<a id="anchor"
		style="position:absolute;top:0;left:0;cursor:pointer;display:block;height:100vh;width:100vw;z-index:10"></a>
	<script type="text/javascript" src="https://cdn.flashtalking.com/frameworks/js/api/2/10/html5API_applenews.js"></script>

	<script type="text/javascript">
		function getAdPath() {
			return location.href.indexOf("flashtalking.com") > -1 ? "https://cdn.flashtalking.com/" + myFT.get("cID") + "/" +
				myFT.get("creativeID") + "/" : ""
		}

		// TODO: conditions for both Large and Double Banners
		function isIphonePlus() {
			return window.innerWidth === 414 || window.innerWidth === 736;
		}
		function inLandscape() {
			return window.innerWidth >= 667
		}

		var sizeAssetsPath = inLandscape() ? "Landscape/" : "Portrait/";
		// TODO: inline ad sizes
		adParams.appleNewsSize = inLandscape() ? '2208x212' : '1242x332'
		// TODO: adjust for current framework
		environments.forEach(function (t) {
			"velvet" === t.id && (t.adPath = getAdPath() + sizeAssetsPath)
		})

		function useStatic() {
			console.log("Index.useStatic()");
			removePreloader();
			document.getElementById("main").style.display = "none";
			document.getElementById("aux").style.display = "block";
			document.body.style =
				"width: " +
				adParams.failoverWidth +
				"px; height: " +
				adParams.failoverHeight +
				"px; overflow: hidden;";
			document.getElementById("fail").style.cssText =
				"position: absolute; " +
				"width: " +
				adParams.failoverWidth +
				"px; height: " +
				adParams.failoverHeight +
				"px; " +
				"left:" +
				adParams.failoverX +
				"px; top:" +
				adParams.failoverY +
				"px; " +
				"background-image: url(" +
				adParams.adPath +
				assets.failover.images[0].source +
				"); background-size: contain; overflow: hidden; ";
		}

		function failAd() {
			console.log("Index.failAd()");
			useStatic();
		}
	</script>

	<script type="text/javascript">
		var global = this;
		var View = {};
		var Network, queryParams, adData;

		/* -- LAUNCH --------------------------------------------
		 *
		 *
		 */
		// immediatelly invoked in inline_entry (node_modules/ad-entry/index.js)
		function prepareIndex() {
			console.log("Index.prepareIndex()");
			return new Promise(
				function (resolve) {
					/*-- Red.Network.onload.start --*/
					if (isDevEnvironment()) {
						var scriptElem = document.createElement("script");
						scriptElem.type = "text/javascript";
						scriptElem.src = matchProtocolTo(
							"https://cdn.flashtalking.com/frameworks/js/api/2/10/html5API_applenews.js"
						);
						document.getElementsByTagName("head")[0].appendChild(scriptElem);
						var ftLoadIntervalId = setInterval(function () {
							if (
								typeof myFT != "undefined" &&
								typeof myFT["instantAds"] != "undefined"
							) {
								clearInterval(ftLoadIntervalId);
								resolve();
							}
						}, 20);
					} else resolve();
					/*-- Red.Network.onload.end --*/
				},
				function (error) {
					global.failAd();
				}
			);
		}

		// ad-params
		function prepareAdParamsMisc() {
			console.log("Index.prepareAdParamsMisc()");
			return new Promise(
				function (resolve) {
					resolve();
				},
				function (error) {
					global.failAd();
				}
			);
		}

		// preloader
		function preparePreloadMisc() {
			console.log("Index.preparePreloadMisc()");
			return new Promise(
				function (resolve) {
					makeAuxClickable();
					resolve();
				},
				function (error) {
					global.failAd();
				}
			);
		}

		function removePreloader() {
			console.log("Index.removePreloader()");

			var preloader = document.getElementById("preloader");
			if (preloader) {
				var aux = document.getElementById("aux");
				aux.style.display = "none";
				aux.removeChild(preloader);
			}
		}

		// exits
		function prepareNetworkExit() {
			console.log("Index.prepareNetworkExit()");
			Network = new(function () {
				/*-- Red.Network.exit.start --*/
				this.exit = function (clickTag) {
					console.log("Network -> STANDARD EXIT");
					window.open(clickTag, "_blank");
				};
				/*-- Red.Network.exit.end --*/

				this.appendMacro = function (_macro, _clickTag) {
					if (_macro.search(/^%%/) > -1) return _clickTag;
					else return _macro + _clickTag;
				};
			})();
		}

		function makeAuxClickable() {
			var aux = document.getElementById("aux");
			aux.setAttribute("onclick", "handleAuxClick()");
		}

		function handleAuxClick() {
			console.log("Index.handleAuxClick()");
			/*-- Red.Network.exit_aux.start --*/
			Network.exit(clickTag);
			/*-- Red.Network.exit_aux.end --*/
		}
	</script>
</body>

</html>