var PrepareCore=new function(){var e=this;var t=undefined;var a=false;var r;e.init=function(e,t){if(typeof global.async=="undefined"){throw new Error("Index migration required. To avoid migration, rollback core/js/control/PrepareCore.js")}r=new Async;r.onComplete(e);r.wait();if(t)n(t);i();o();s();Device.init();Device.trace();CssManager.init();r.done()};function n(e){ImageManager.addFbaImages(e)}function i(){if(typeof views!=="undefined"){var e=views.call();if(e.length){r.wait();global.Views={};global.ViewStyles={};new ViewLoader(e,{name:"viewLoader",onComplete:function(){r.done()}}).load()}}}function o(){ImageManager.addLoader(new Loader(assets.images,{name:"indexImages",prepend:adParams.imagesPath}));ImageManager.addLoader(new Loader(assets.edgeImages,{name:"edgeImages",prepend:adParams.edgePath}))}function s(){r.wait();fontLoader=new Loader({name:"fontLoader",onComplete:l,onFail:global.failAd,scope:e});fontLoader.add(new Loader(assets.fonts,{name:"fontSubLoader",prepend:adParams.fontsPath,fileType:"ttf"}));fontLoader.add(new Loader(assets.edgeFonts,{name:"fontEdgeSubLoader",prepend:adParams.fontsPath,fileType:"ttf"}));fontLoader.load()}function l(){r.done()}};var Device=new function(){var e=this;e.pixelRatio=window.devicePixelRatio||"unknown";Object.defineProperties(e,{orientation:{get:function(){return window.innerWidth>window.innerHeight?"landscape":"portrait"}},dimensions:{get:function(){return{width:window.innerWidth,height:window.innerHeight}}}});e.init=function(){e.agentString=navigator.userAgent;for(var t in e){if(t!="init"&&t!="trace"&&typeof e[t]=="function"){e[t].call()}}if(e.type!=="desktop"&&e.os==="windows"&&e.osVersion<=8&&e.browser==="ie"&&e.browserVersion<12){e.type="desktop"}};e.trace=function(){var t=Array(70).join("-");var a="\n"+t;a+="\n AGENT:\n\n\t"+e.agentString+"\n";a+="\n  Brand:\t\t\t"+e.brand;a+="\n  Product:\t\t\t"+e.product;a+="\n  Type:\t\t\t\t"+e.type;a+="\n  Os:\t\t\t\t"+e.os+" - "+e.osVersion;a+="\n  Browser:\t\t\t"+e.browser+" - "+e.browserVersion;a+="\n  Dimensions: \t\t"+e.dimensions.width+"x"+e.dimensions.height;a+="\n  Orientation:\t\t"+e.orientation;a+="\n  Pixel Ratio:\t\t"+e.pixelRatio;a+="\n"+t};e._getType=function(){var t=/(android|mobile)/gi.exec(e.agentString);var a=/(tablet|touch)/gi.exec(e.agentString);var r=/(ipad)/gi.exec(e.agentString);e.type="desktop";if(t)e.type="mobile";if(a)e.type="tablet";if(r)e.type="tablet"};e._getBrandAndOS=function(){var t=e.agentString.match(/ip(hone|od|ad)|mac/gi);if(t){e.brand="apple";e.product=t[0].toLowerCase();var a=/(OS\s)(\X\s|)([\d\.\_]+)/gi.exec(e.agentString);e.os=a[2]==""?"ios":"osx";e.osVersion=a[3].replace(/\_/g,".");return}var r=/(android)\/?\s*([0-9\.]+)/gi.exec(e.agentString);if(r){e.brand=e.product=e.os=r[1].toLowerCase();e.osVersion=r[2];return}var n=/(windows\snt\s|windows\sphone)\/?\s*([0-9\.]+)/gi.exec(e.agentString);if(n){e.brand="microsoft";e.os="windows";switch(n[2]){case"5.2":e.osVersion="xp";break;case"6.0":e.osVersion="vista";break;case"6.1":e.osVersion="7";break;case"6.2":e.osVersion="8";break;case"6.3":e.osVersion="8.1";break;case"10.0":e.osVersion="10";break;default:e.osVersion=n[2]}e.product=n[1].toLowerCase();if(e.product.match(/\snt/i)){e.product="pc"}return}var i=e.agentString.match(/(blackberry|bb10|playbook)/i);if(i){e.brand=e.product=e.os="blackberry";e.osVersion=/(version)\/?\s*([0-9\.]+)/gi.exec(e.agentString)[2]}};e._getBrowser=function(){var t=/(edge(?=\/))\/?\s*([0-9\.]+)/i.exec(e.agentString);if(!t){t=e.agentString.match(/(fban|fbav|opera|chrome|crios|safari|firefox|msie|trident(?=\/))\/?\s*([0-9\.]+)/i)}if(!t||t.length<3){switch(e.os){case"ios":e.browser="safari";break;case"windows":e.browser="trident";break;default:e.browser="chrome";break}e.browserVersion="os-default";return}e.browser=t[1].toLowerCase();e.browserVersion=t[2];switch(e.browser){case"trident":var a=/\brv:+(\d+)/g.exec(e.agentString);if(a)e.browserVersion=a[1];case"msie":e.browser="ie";break;case"crios":e.browser="chrome";break;case"safari":var a=e.agentString.match(/\sversion\/([0-9\.]+)\s/i);if(a)e.browserVersion=a[1];break;case"chrome":var a=e.agentString.match(/\b(OPR)\/([0-9\.]+)/i);if(a){e.browser="opera";e.browserVersion=a[2]}break}}};var CssManager=new function(){var e=this;e.init=function(){e.generateBrowserKeyDictionary()};e.debug_level1=false;e.debug_level2=false;e.filter;e.debug_element;e.debug_css_list;e.setDebugLevel=function(t){switch(parseInt(t)){case 1:e.debug_level1=true;e.debug_level2=false;break;case 2:e.debug_level1=true;e.debug_level2=true;break;default:e.debug_level1=false;e.debug_level2=false;break}};e.setDebugFilter=function(t){e.filter=t;e.debug_level1=true};e.ifDebug=function(t){if(!e.filter)return e[t];else if(e.passDebugFilter()&&e[t])return true};e.passDebugFilter=function(){if(e.debug_element)if(e.debug_element.id.indexOf(e.filter)>-1)return true;if(e.debug_css_list)for(var t in e.debug_css_list){if(t.indexOf(e.filter)>-1)return true;else if(String(e.debug_css_list[t]).indexOf(e.filter)>-1)return true}return false};e.deviceKeyDict;e.generateBrowserKeyDictionary=function(){e.deviceKeyDict={};var t=document.createElement("div").style;for(var a in t){var r=e.getPrefix(a);var n=e.standardizeKey(a);switch(Device.browser){case"safari":if(r=="webkit"){e.deviceKeyDict[n]=e.prependPrefix("webkit",n)}else{if(!(e.prependPrefix("webkit",n)in t)){e.deviceKeyDict[n]=n}}break;case"firefox":var i=e.prependPrefix("Moz",n);var o=e.prependPrefix("Webkit",n);if(n in t){e.deviceKeyDict[n]=n}else if(r=="moz"){if(e.camelateKey("webkit-"+n)in t){e.deviceKeyDict[n]=i}}else if(r=="webkit"){if(!(i in t)){e.deviceKeyDict[n]=o}}break;case"chrome":case"ie":default:if(n in t){e.deviceKeyDict[n]=n}else if(r){e.deviceKeyDict[n]=e.prependPrefix(r,n)}break}}};e.apply=function(t,a){e.debug_element=t;e.debug_css_list=a;var r={};for(var n in a){if(n.match(/^transform\(/))r[n]=a[n];else{t.style[e.getDeviceKey(n)]=a[n]}}e.applyTransforms(t,r);e.debug_element=null;e.debug_css_list=null};e.conformCssObject=function(t,a){e.debug_element=a;var r={};if(t){for(var n in t){var i=e.conformKeyValue(n,t[n]);for(var o in i){r[i[o][0]]=i[o][1]}}}e.debug_element=null;return r};e.conformCssString=function(t,a){e.debug_element=a;var r={};if(t){var n=t.split(/\s*;\s*/);for(var i in n){if(n[i]){var o=n[i].split(/:(.+)?/);var s=e.conformKeyValue(o[0],o[1]);for(var l in s){r[s[l][0]]=s[l][1]}}}}e.debug_element=null;return r};e.conformCssKeyValue=function(t,a){var r={};r[t]=a;return e.conformCssObject(r)};e.applyTransforms=function(t,a){var r=new Matrix2D;var n=t.style[e.getDeviceKey("transform")];var i=n.match(/matrix[^\)]+\)/);if(i){r.setFromCss(i[0])}if("transforms"in t)var o=t.transforms;else{var o={tx:0,ty:0,rz:0,sx:1,sy:1}}var s={};for(var l in a){var c=l.match(/\(\s([^\s]+)/)[1];s[c]=a[l]}if(s.tx!=undefined){r.data[2]=0}if(s.ty!=undefined){r.data[5]=0}if(s.rz!=undefined){var u=-o.rz;r.rotate(u*(Math.PI/180));r.rotate(s.rz*(Math.PI/180));o.rz=s.rz}if(s.sx!=undefined){var u=1/o.sx;r.scale(u,1);r.scale(s.sx,1);o.sx=s.sx}if(s.sy!=undefined){var u=1/o.sy;r.scale(1,u);r.scale(1,s.sy);o.sy=s.sy}if(s.tx!=undefined){r.translate(s.tx,0);o.tx=s.tx}if(s.ty!=undefined){r.translate(0,s.ty);o.ty=s.ty}t.transforms=o;t.style[e.getDeviceKey("transform")]=r.getCss()};e.conformKeyValue=function(t,a){t=String(t).trim();a=String(a).trim();var r=e.standardizeKey(t);return e.conformValue(r,a)};e.hasPrefix=function(e){return e.search(a())>-1};e.getPrefix=function(e){var t=e.match(a());return t?t[1].replace(/-/g,"").toLowerCase():null};e.stripPrefix=function(e){var t=e.replace(a(),"");return t.charAt(0).toLowerCase()+t.slice(1)};e.getDeviceKey=function(t){return t in e.deviceKeyDict?e.deviceKeyDict[t]:t};e.prependPrefix=function(e,t){return e+t.replace(/^(.)/,function(e){return e.charAt(0).toUpperCase()})};e.standardizeKey=function(t){t=e.stripPrefix(t);if(t in e.keyFormatExceptions())t=e.keyFormatExceptions()[t];else t=e.camelateKey(t);return t};e.camelateKey=function(e){e=e.replace(/-(.)/g,function(e){return e.charAt(1).toUpperCase()});return e};e.keyFormatExceptions=function(){return{x:"transform( tx )",translateX:"transform( tx )",y:"transform( ty )",translateY:"transform( ty )",rotate:"transform( rz )",rotation:"transform( rz )",scaleX:"transform( sx )",scaleY:"transform( sy )",scale:"transform( sx ),transform( sy )"}};e.conformValue=function(e,a){var r=[];var n;var i=a.match(/\s/);var o=a.match(t());if(!i&&o){n=Number(o[0]);var s=a.match(/[^0-9\.]+$/);if(s)n+=s[0];else switch(e){case"top":case"right":case"bottom":case"left":case"width":case"height":case"fontSize":case"lineHeight":case"padding":case"margin":case"marginRight":case"marginLeft":case"marginTop":case"marginBottom":case"borderRadius":case"borderWidth":case"letterSpacing":n+="px";break}}else if(e=="backgroundImage"){a=a.replace(/^url\(\s*['"]*/,"").replace(/['"]*\s*\)$/,"");n='url( "'+a+'" )'}else if(e=="transform"){var l=/([a-z0-9]+)\(([^\)]+)\)/gi;while(params=l.exec(a)){var c=params[2].replace(/\s/g,"").split(",").map(function(e,a,r){return Number(e.match(t())[0])});switch(params[1]){case"translate":r.push(["transform( tx )",c[0]]);r.push(["transform( ty )",c[1]]);break;case"translateX":r.push(["transform( tx )",c[0]]);break;case"translateY":r.push(["transform( ty )",c[0]]);break;case"rotate":r.push(["transform( rz )",c[0]]);break;case"scale":r.push(["transform( sx )",c[0]]);r.push(["transform( sy )",c[1]]);break;case"scaleX":r.push(["transform( sx )",c[0]]);break;case"scaleY":r.push(["transform( sy )",c[0]]);break}}}else{n=a}if(n!=undefined){var u=e.split(/\,/);for(var f=0;f<u.length;f++){r.push([u[f],n])}}return r};function t(){return/^[+-]?[0-9]*\.?[0-9]+/}function a(){return/^-*(moz-*|webkit-*|ms-*|o-)/i}};var ImageManager=new function(){var e=this;var t=[];var a=[];var r=[];var n=[];var i;var o={};var s=false;var l=0;var c=function(){};var u;e.addToLoad=function(r,n){var i=LoaderUtils.getFileName(r);if(!e.available(i,true)){var o=n&&n.forCanvas==true;o?a.push(r):t.push(r)}return i};e.addLoader=function(e){r.push(e)};e.get=function(e){if(o[e])return o[e];else throw new Error("ImageManager : No image named '"+e+"' has been loaded")};e.available=function(e,t){var a=o[e]!=undefined;if(a){}else{}return a};e.load=function(e,o){u=o||global.failAd;if(s){n.push(e)}else{i=new Loader({name:"imageManagerLoader",onComplete:d,onFail:g});c=[].concat(e);n=[];var f=t.slice();t=[];i.add(new Loader(f,{name:"dynamicImages-"+l++,fileType:"jpg"}));var v=a.slice();a=[];i.add(new Loader(v,{name:"dynamicCanvasImages-"+l++,fileType:"jpg",crossOrigin:"anonymous"}));var h=r.slice();r=[];for(var m=0;m<h.length;m++){i.add(h[m])}s=true;i.load()}};e.addFbaImages=function(e){if(e)f(e.getAllContentRaw())};function f(t){for(var a=0;a<t.length;a++){if(t[a]instanceof Image||t[a]instanceof SVGElement){var r=t[a];if(!e.available(t[a].id,true))o[r.id]=r}}for(var a=0;a<c.length;a++)c[a].call();if(n.length>0){e.load(n)}}function d(e){s=false;f(e.getAllContentRaw())}function g(){s=false;u.call()}};var Styles=new function(){var e=this;e.setCss=function(e,t){e=Markup.get(e);var a={};if(arguments.length>2){for(var r=1;r<arguments.length;r+=2){a=CssManager.conformCssKeyValue(arguments[r],arguments[r+1])}}else if(typeof arguments[1]=="string"){a=CssManager.conformCssString(arguments[1],e)}else{a=CssManager.conformCssObject(arguments[1],e)}CssManager.apply(e,a)};e.getCss=function(e,t){e=Markup.get(e);var a;if(t=="x"||t=="y"){var r=e.style[CssManager.getDeviceKey("transform")];var n=r.replace(/[\s\(\)matrix]/g,"").split(",");a=n.length<6?0:+n[t=="x"?4:5]}else{var i=window.getComputedStyle(e,null);a=i.getPropertyValue(t).replace(/px/,"");if(!isNaN(a))a=parseInt(a,10)}return a};e.injectStylesheet=function(e,t){if(document.getElementById(e)){return}var a=document.createElement("style");a.type="text/css";a.id=e;var r=arguments.length===2?t:"";if(arguments.length>2){for(var n=0;n<arguments.length-1;n+=2){var i=arguments[n+1].replace(/\,\s+/g,",");r+=i;r+=" { "+(arguments[n+2]||"")+" }\n"}}a.innerHTML=r;document.getElementsByTagName("head")[0].appendChild(a)};e.addClass=function(e,t){var a=Markup.get(e);for(var r=0;r<arguments.length-1;r++){a.classList.add(arguments[r+1])}};e.removeClass=function(e,t){var a=Markup.get(e);a.classList.remove(t)}};var Markup=new function(){var e=this;e.get=function(e,t){if(typeof e!=="string"){return e}t=t||document;e=e.trim();switch(e[0]){case"#":return t.getElementById(e.slice(1));break;case".":return t.getElementsByClassName(e.slice(1));break;case"<":return t.getElementsByTagName(e.slice(1,e.length-1));break;default:return t.getElementById(e)}};e.getElement=function(t,a){return e.get(t,a)};e.removeChildren=function(e){var t=Markup.get(e);while(t.firstChild){t.removeChild(t.firstChild)}};e.applyContainerCss=function(e,t){if(!t.css)t.css={};if(!t.css.position)t.css.position="absolute";Styles.setCss(e,t.css);Styles.setCss(e,t.styles)};e.addiFrame=function(e){var t=document.createElement("iFrame");t.id=e.id;t.width=e.css.width;t.height=e.css.height;delete e.css.width;delete e.css.height;t.setAttribute("src",e.source);t.setAttribute("frameborder","0");t.setAttribute("scrolling","no");t.setAttribute("allowfullscreen","");Markup.applyContainerCss(t,e);e.target.appendChild(t);return t};e.addSvg=function(e){var t="http://www.w3.org/2000/svg";var a=document.createElementNS(t,"svg");a.setAttribute("height",e.height);a.setAttribute("width",e.width);var r=document.createElementNS(t,"path");r.setAttribute("d",e.d);r.setAttribute("fill",e.fill);if(e.stroke!=undefined){r.setAttribute("stroke",e.stroke)}if(e.strokeWidth!=undefined){r.setAttribute("stroke-width",e.strokeWidth)}a.appendChild(r);Markup.applyContainerCss(a,e);e.target.appendChild(a);return a};e.applyToElements=function(e){if(e.elements.length===undefined){e.method.call(e.scope,e.elements,e.methodArg)}else{var t;for(t=0;t<e.elements.length;t++){var a=e.elements[t];e.method.call(e.scope,a,e.methodArg)}}}};var Align=function(){var e=[{x:"offsetWidth",y:"offsetHeight",parent:"parentNode"},{x:"width",y:"height",parent:"stage"}];function t(t,a){var i=t.canvas||Markup.get(t);var o={};var s=a.snap!==false;var l=n(t)?0:1;if(typeof a=="string")a=r(a);for(var c in a){if(c=="x"||c=="y"){var u=a[c];if(!u)continue;if(typeof u=="string")u={type:u};var f;var d;var g=0;var v=false;var h=u.offset||0;var m;if(u.against!==undefined){m=true;f=u.against;var p=0;if(n(f)){if(f.canvas)p=1;else g=Styles.getCss(f,c)}else if(typeof f==="number"){v=true;g=f}else{g=f[c];p=1}d=e[p][c];if(u.type===Align.CENTER)a[c].outer=false}else{f=i[e[l].parent];d=e[l][c]}var y=i[e[l][c]];switch(t._type){case"arc":case"path":switch(u.type){case Align.CENTER:y=0;break;default:h+=y/2;break}break;case"text":if(c==="x"){switch(t.alignText){case"center":y=0;case"right":y*=-1}}break}y/=t.qualityScale||1;var b=r(u.type,y,v?0:f[d]/(f.qualityScale||1),!v&&!!a[c].outer);if(b!=null){b+=g+h;o[c]=s?Math.round(b):b}}}return o}function a(e,a){var r=t(e,a);if(n(e)){var i=e.canvas||Markup.get(e);Styles.setCss(i,r)}else{for(var o in r)e[o]=r[o]}return r}function r(e,t,a,r){var n=arguments.length==1;switch(e){case"alignBottom":if(r)t=0;if(!n)return a-t;case"alignTop":return n?{y:e}:r?-t:0;case"alignRight":if(r)a+=t;if(!n)return a-t;case"alignLeft":return n?{x:e}:r?-t:0;case"alignCenter":if(r)a=0;return n?{x:e,y:e}:(a-t)/2;default:return null}}function n(e){return e instanceof HTMLElement||e.canvas!=undefined}return{BOTTOM:"alignBottom",CENTER:"alignCenter",LEFT:"alignLeft",RIGHT:"alignRight",TOP:"alignTop",BOTTOM_LEFT:"alignBottomLeft",BOTTOM_RIGHT:"alignBottomRight",TOP_LEFT:"alignTopLeft",TOP_RIGHT:"alignTopRight",get:t,set:a,calculate:r}}();function UIDiv(e,t){Styles.injectStylesheet("RED_uiElement",".ui-elem","position:absolute;");t=t||"div";var a=document.createElement(t);Styles.addClass(a,"ui-elem");e=e||{};if(e.id)a.id=e.id;Styles.setCss(a,e.css);if(e.target){var r=Markup.get(e.target);r.appendChild(a)}Object.defineProperty(a,"parent",{get:function(){return a.parentNode}});a.toString=function(){return"[object UIDiv]"};return a}function UIComponent(e,t){var a=true;var r=true;var n=t||"div";e=e||{};t=n=="svg"?"div":t;var i=new UIDiv(e,t);i._align=e.align;Object.defineProperties(i,{x:{get:function(){return Styles.getCss(i,"x")},set:function(e){Styles.setCss(i,{x:e})}},y:{get:function(){return Styles.getCss(i,"y")},set:function(e){Styles.setCss(i,{y:e})}},enabled:{get:function(){return a},set:function(e){a=e;i.dispatchEvent(UIEvent.componentEnabled)}},showing:{get:function(){return r},set:function(){}}});if(n!="canvas"&&n!="svg"){Object.defineProperties(i,{width:{get:function(){return i.offsetWidth},set:function(e){Styles.setCss(i,{width:e});var t=new CustomEvent(UIEvent.RESIZE);t.direction="width";i.dispatchEvent(t)}},height:{get:function(){return i.offsetHeight},set:function(e){Styles.setCss(i,{height:e});var t=new CustomEvent(UIEvent.RESIZE);t.direction="height";i.dispatchEvent(t)}}})}i.hide=function(){i.style.display="none";r=false};i.show=function(){try{i.style.removeProperty("display")}catch(e){i.style.display=null}r=true};i.setCss=function(e){Styles.setCss(i,e)};i.addChild=function(e){var t=Markup.get(e);i.appendChild(t);if(e._align)Align.set(e,e._align)};i.inspect=function(){var e={};var t=Object.getOwnPropertyNames(i);for(var a=0;a<t.length;a++){var r=i[t[a]];e[t[a]]=r}};i.toString=function(){return"[object UIComponent]"};i._initAlign=function(t){var a=t?t==true:e.target!=undefined;if(e.align&&a){Align.set(i,e.align)}};i.enabled=true;i._initAlign();return i}function UIImage(e){Styles.injectStylesheet("RED_uiImage",".ui-image","background-repeat:no-repeat; background-size:contain;");var t=true;var a=null;var r=false;var n="contain";var i=!!e.aspectRatio;var o=e.css||{};if(!e.source)throw new Error("UIImage : No image source set on '"+e.id+"'");e.css=e.css||{};var s=new UIComponent(e);Styles.addClass(s,"ui-image");Object.defineProperties(s,{source:{get:function(){return a},set:function(e){a=ImageManager.get(e);s.style.backgroundImage="url("+a.src+")"}},retina:{get:function(){return r},set:function(e){r=e;l()}},ratio:{get:function(){return n},set:function(e){n=e;s.style.backgroundSize=e}},aspectRatio:{get:function(){return i},set:function(e){i=e;l()}}});s.toString=function(){return"[object UIImage]"};function l(n){var o=r?2:1;var l=a.width/a.height;var c=e.css.width||a.width;var u=e.css.height||a.height;var f=e.css.width==undefined;var d=e.css.height==undefined;if(!t){f=n=="height";d=n=="width";c=s.width;u=s.height}if(f){var g;if(i&&!d){g=u*l}else{g=c/o}s.style.width=Math.round(g)+"px"}if(d){var v;if(i&&!f){v=c/l}else{v=u/o}s.style.height=Math.round(v)+"px"}}function c(e){l(e.direction)}s.addEventListener(UIEvent.RESIZE,c);s.source=e.source;s.retina=!!e.retina;if(e.ratio)s.ratio=e.ratio;s._initAlign();t=false;return s}function UITextField(e){Styles.injectStylesheet("RED_uiTextfield",".ui-textfield","position:absolute; white-space:nowrap;",".smooth-text","-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;",".ui-textfield .content","position:relative; display:table-cell; cursor:default; pointer-events:none; line-height:100%; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;");var t;var a=0;var r;var n="";var i;var o;var s={top:0,bottom:0,left:0,right:0};var l="";var c=true;var u;var f;var d={};e=e||{};var g=new UIComponent(e);Styles.addClass(g,"ui-textfield");var v=document.createElement("span");Styles.addClass(v,"content");g.appendChild(v);Object.defineProperties(g,{alignText:{get:function(){return t},set:function(e){if(e&&t!=e){t=e;var a=(t.match(/(left|right)/gi)||["center"])[0].toLowerCase();Styles.setCss(g,{lineHeight:g.height,textAlign:a});u=(t.match(/(bottom|top)/gi)||["middle"])[0].toLowerCase();Styles.setCss(v,{verticalAlign:u})}}},fontSize:{get:function(){return a},set:function(e){if(!isNaN(e)&&e>0){a=e;g.style.fontSize=~~e+"px";m()}}},fontFamily:{get:function(){return r},set:function(e){r=e;g.style.fontFamily=e;m()}},format:{get:function(){return n},set:function(e){if(n!=e){n=e;Styles.setCss(g,{whiteSpace:/inline/g.exec(n)!=null?"nowrap":"normal"});m()}}},leading:{get:function(){return i},set:function(e){if(e&&i!=e){i=e;Styles.setCss(v,{lineHeight:i*100+"%"});m()}}},spacing:{get:function(){return Styles.getCss(g,"letter-spacing")||o},set:function(e){if(e&&o!=e){o=e;Styles.setCss(g,{letterSpacing:e});m()}}},bufferText:{get:function(){return s},set:function(e){if(e&&s!=e){var t="";var a=["top","right","bottom","left"];for(var r=0;r<4;r++){var n=a[r];var i=isNaN(e)?e[n]||0:e;s[n]=i;t+=i+"px "}Styles.setCss(v,{padding:t});m()}}},text:{get:function(){return l},set:function(e){if(e!=undefined&&e!=""){l=e;g.setDefault("text",e);v.innerHTML=e;m()}}},smoothing:{get:function(){return f},set:function(e){f=e;Styles[f?"addClass":"removeClass"](v,"smooth-text")}}});g.resetToDefault=function(){c=true;if(arguments.length>0){for(var e=0;e<arguments.length;e++){g[arguments[e]]=d[arguments[e]]}}else{for(var t in d){if(g[t]!=undefined){g[t]=d[t]}}}c=false;m()};g.setDefault=function(e,t){d[e]=t};g.toString=function(){return"[object UITextfield]"};function h(){for(var t in e){if(t=="css"){for(var a in e.css){switch(a){case"x":case"y":case"width":case"height":d[a]=e.css[a];break}}}else if(t=="bufferText"){d[t]={};for(var r in s){d[t][r]=e[t][r]||0}}else{d[t]=e[t]}}delete d.target;delete d.id}function m(){if(c)return;switch(n){case"paragraphClamp":case"inlineClamp":y();break;case"inlineFitClamp":n="inlineFit";p();n="inlineClamp";y();n="inlineFitClamp";break;case"paragraphFitClamp":n="paragraphFit";p();n="paragraphClamp";y();n="paragraphFitClamp";default:p()}}function p(){Styles.setCss(v,{verticalAlign:"auto",height:"auto",width:"auto"});if(n=="paragraphFit"){var e=a;while(g.scrollHeight>g.offsetHeight){if(e<=0)break;e--;g.style.fontSize=e+"px"}while(g.scrollWidth>g.offsetWidth){if(e<=0)break;e--;g.style.fontSize=e+"px"}a=e;g.style.fontSize=a+"px"}else if(n=="inlineFit"){var t=g.offsetWidth;var r=g.offsetHeight;g.style.fontSize="243px";var i=v.offsetWidth;var o=v.offsetHeight;g.style.fontSize="182px";var l=v.offsetWidth;var c=v.offsetHeight;var f=MathUtils.rel(243,182,i,l,t);var d=MathUtils.rel(243,182,o,c,r);a=~~Math.min(a,Math.min(f,d));g.style.fontSize=a+"px"}if(u){Styles.setCss(v,{verticalAlign:u,height:g.offsetHeight-s.top-s.bottom,width:g.offsetWidth-s.left-s.right})}}function y(){Styles.setCss(v,{height:"auto",width:"auto"});g.width=v.offsetWidth;g.height=v.offsetHeight}g.enabled=true;h();g.format=e.format;g.fontSize=e.fontSize;g.fontFamily=e.fontFamily||"Arial";g.alignText=e.alignText;g.bufferText=e.bufferText;g.leading=e.leading;g.spacing=e.spacing;g.smoothing=e.smoothing!=false;c=false;g.text=e.text;g._initAlign();return g}function UIGroup(e){var t=new UIComponent(e);var a=e.children;while(a.length>0)t.appendChild(a.shift());Clamp.set(t,Clamp.XY);if(e.align)Align.set(t,e.align);return t}var TextFormat=function(){return{INLINE:"inline",INLINE_CLAMP:"inlineClamp",INLINE_FIT:"inlineFit",INLINE_FIT_CLAMP:"inlineFitClamp",PARAGRAPH:"paragraph",PARAGRAPH_CLAMP:"paragraphClamp",PARAGRAPH_FIT:"paragraphFit",PARAGRAPH_FIT_CLAMP:"paragraphFitClamp"}}();var UIEvent=function(){var e=new CustomEvent("uiComponentEnabled");var t=new CustomEvent("uiSliderUpdate");return{ENABLED:"uiComponentEnabled",RESIZE:"uiResize",SLIDER_UPDATE:"uiSliderUpdate",componentEnabled:e,sliderUpdate:t}}();var Gesture=new function(){var e=this;var t=[];var a=[];var r=document.createEventObject!=undefined;var n=false;e._kills={};e.add=e.addEventListener=function(e,t,a){var r=i(e);r.register(t,a);Styles.setCss(e,"cursor","pointer");Styles.setCss(e,"pointer-events","auto")};e.remove=e.removeEventListener=function(e,t,a){var r=i(e);if(r){r.unregister(t,a);if(r.eventList.length<=0){Styles.setCss(e,"cursor","auto")}}};e.disable=function(e){var t=i(e);a.push(t);if(r){t.register(GestureEvent.CLICK,u);Styles.setCss(e,"cursor","auto")}else{Styles.setCss(e,"pointer-events","none")}};e.disableChildren=function(e){s(e,false)};e.enable=function(e){var t=i(e);for(var n=0;n<a.length;n++){if(t==a[n]){if(r){t.unregister(GestureEvent.CLICK,u)}else{Styles.setCss(e,"pointer-events","auto");Styles.setCss(e,"cursor","pointer")}break}}};e.enableChildren=function(e){s(e,true)};function i(e){var a=null;for(var r=0;r<t.length;r++){if(t[r].elem===e){a=t[r];break}}if(!a){a=o(e)}return a}function o(e){var a=new GestureBase(e);t.push(a);return a}function s(t,a){var r=i(t);if(r.hasActiveChildren!=a){r.hasActiveChildren=a;var n=r.elem.getElementsByTagName("*");for(var o=0;o<n.length;o++){if(n[o].parentNode==t){a?e.enable(n[o]):e.disable(n[o])}}}}function l(e,t,r,n){e.style.visibility="hidden";n.push(e);var i=document.elementFromPoint(t,r);for(var o=0;o<a.length;o++){if(a[o].elem==i){return l(i,t,r,n)}}return i}function c(e){var t=[];var a=l(e.target,e.clientX,e.clientY,t);for(var r=0;r<t.length;r++){t[r].style.visibility="visible"}t=[];e.stopImmediatePropagation();return a}function u(e){var t=c(e);var a=document.createEvent("HTMLEvents");a.initEvent(e.type,true,false);t.dispatchEvent(a)}};function GestureBase(e){var t=this;t.elem=e;t.hasActiveChildren=true;t.debug=false;t.eventList=[];t._isDragEnabled=false;t._isDragging=false;t._give=2;t._oX=0;t._oY=0;t._p1X=0;t._p1Y=0;t._p2X=0;t._p2Y=0;t._sX=0;t._sY=0;t._vX=0;t._vY=0;t._cursor="mouse";t._start="down";t._end="up";t.init()}GestureBase.prototype={init:function(){var e=this;e._handleTouchStart=e._handleTouchStart.bind(e);e._handleDown=e._handleDown.bind(e);e._handleDrag=e._handleDrag.bind(e);e._handleUp=e._handleUp.bind(e);e._elemAdd=e.elem.addEventListener.bind(e.elem);e._elemRemove=e.elem.removeEventListener.bind(e.elem);e._reset()},register:function(e,t){var a=this;a.eventList.push(e);a._checkDragEnabled();a._elemAdd(e,t)},unregister:function(e,t){var a=this;var r=a.eventList.indexOf(e);if(r>=0){a.eventList.splice(r,1)}a._checkDragEnabled();a._elemRemove(e,t)},_reset:function(){var e=this;e._cursor="mouse";e._start="down";e._end="up";e.elem.addEventListener("touchstart",e._handleTouchStart);if(Device.os!="ios")e.elem.addEventListener("mousedown",e._handleDown)},_checkDragEnabled:function(){var e=this;var t=e.eventList.join("").indexOf("onDrag");e._isDragEnabled=t>-1},_getEventScope:function(e){return e.changedTouches?e.changedTouches[0]:e},_add:function(e,t){window.addEventListener(this._cursor+e,t)},_remove:function(e,t){window.removeEventListener(this._cursor+e,t)},_handleDown:function(e){var t=this;GestureEvent.startPoint();t.elem.removeEventListener("touchstart",t._handleTouchStart);if(Device.os!="ios")t.elem.removeEventListener("mousedown",t._handleDown);t._isDragging=false;t._add(t._end,t._handleUp);t._add("move",t._handleDrag);var a=t._getEventScope(e);var r=a.pageX;var n=a.pageY;var i=t.elem.getBoundingClientRect();var o=r-i.left;var s=n-i.top;var l=t.elem.x||Styles.getCss(t.elem,"x");var c=t.elem.y||Styles.getCss(t.elem,"y");var u=i.left-l;var f=i.top-c;t._oX=u+o;t._oY=f+s;var d=r-t._oX;var g=n-t._oY;t._sX=t._p1X=t._p2X=r;t._sY=t._p1Y=t._p2Y=n;v("onPress");function v(e){if(GestureEvent.stopped(e))return;var a=new GestureEvent.Event(e,r,n,o,s,d,g);t.elem.dispatchEvent(a)}},_handleUp:function(e,t){var a=this;a._remove(a._end,a._handleUp);a._remove("move",a._handleDrag);var r=a._getEventScope(e);var n=r.pageX;var i=r.pageY;var o=a.elem.getBoundingClientRect();var s=n-o.left;var l=i-o.top;var c=n-a._oX;var u=i-a._oY;var f;if(t!==true){m("onRelease")}var d=o.top+window.pageYOffset;var g=d+o.height;var v=o.left+window.pageXOffset;var h=v+o.width;if(a._isDragging){if(a._isDragEnabled){a._dragEndOrSwipe("onDragStop")}}else{if(n>v&&n<h&&i>d&&i<g){m("onSelect")}}function m(e){if(GestureEvent.stopped(e))return;var t=new GestureEvent.Event(e,n,i,s,l,c,u,0,0,a._vX,a._vY);a.elem.dispatchEvent(t)}if(a._isDragging){a._dragEndOrSwipe("onSwipe")}a._reset();e.preventDefault();GestureEvent.endPoint()},_handleTouchStart:function(e){var t=this;t._cursor="touch";t._start="start";t._end="end";t._handleDown(e)},_handleDrag:function(e){var t=this;var a=t._getEventScope(e);var r=a.pageX;var n=a.pageY;var i=r-t._p1X;var o=r-t._p2X;t._vX=(o-i)/2+i;var s=n-t._p1Y;var l=n-t._p2Y;t._vY=(l-s)/2+s;var c=r-t._oX;var u=n-t._oY;var f=t.elem.getBoundingClientRect();var d=r-f.left;var g=n-f.top;var v;if(t._isDragging){if(t._isDragEnabled){h("onDrag")}}else{if(Math.abs(t._sX-r)>t._give||Math.abs(t._sY-n)>t._give){t._isDragging=true;if(t._isDragEnabled){h("onDragStart")}}}function h(e){if(GestureEvent.stopped(e))return;var a=new GestureEvent.Event(e,r,n,d,g,c,u,t._p1X-t._sX,t._p1Y-t._sY,t._vX,t._vY);t.elem.dispatchEvent(a)}t._p2X=t._p1X;t._p1X=r;t._p2Y=t._p1Y;t._p1Y=n},_dragEndOrSwipe:function(e){var t=this;if(GestureEvent.stopped(name))return;var a=t.elem.getBoundingClientRect();var r=new GestureEvent.Event(e,t._p1X,t._p1Y,t._p1X-a.left,t._p1Y-a.top,t._p1X-t._oX,t._p1Y-t._oY,t._p2X-t._sX,t._p2Y-t._sY,t._vX,t._vY);t.elem.dispatchEvent(r)}};var GestureEvent=new function(){var e={};var t=false;function a(e,t,a,r,n,i,o,s,l,c,u){var f=new CustomEvent(e);f.mouse={global:{x:t,y:a},local:{x:r,y:n}};f.element={x:i||0,y:o||0};f.distance={x:s||0,y:l||0};f.velocity={x:c||0,y:u||0};f.direction={x:c>0?"right":c<0?"left":null,y:u>0?"down":u<0?"up":null};return f}function r(t){if(t){t.stopImmediatePropagation();e[t.type]=true}}function n(t){return e[t]!=undefined}function i(){if(!t){t=true;e={}}}function o(){t=false}return{OVER:"mouseover",OUT:"mouseout",MOVE:"mousemove",PRESS:"onPress",RELEASE:"onRelease",CLICK:"onSelect",DRAG:"onDrag",DRAG_START:"onDragStart",DRAG_STOP:"onDragStop",SWIPE:"onSwipe",stop:r,Event:a,stopped:n,startPoint:i,endPoint:o}};var Matrix2D=function(){var e=this;e.identity=new Float32Array([1,0,0,0,1,0]);e.data=new Float32Array(e.identity)};Matrix2D.prototype={clear:function(){var e=this;e.data=new Float32Array(e.identity)},rotate:function(e){var t=this;var a=new Float32Array(t.identity);var r=Math.cos(e).toFixed(15);var n=Math.sin(e).toFixed(15);a[0]=r;a[1]=n;a[3]=-n;a[4]=r;t.multiply(a,false);return t},scale:function(e,t){var a=this;var r=new Float32Array(a.identity);r[0]=e;r[4]=t;a.multiply(r,false);return a},skew:function(e,t){var a=this;var r=new Float32Array(a.identity);r[1]=Math.tan(e);r[3]=Math.tan(t);a.multiply(r);return a},translate:function(e,t){var a=this;var r=new Float32Array(a.identity);r[2]=e||0;r[5]=t||0;a.multiply(r,true);return a},multiply:function(e,t){var a=this;var r=new Float32Array(a.data);var n=t?e:r;var i=t?r:e;for(var o=0;o<6;o++){var s=Math.floor(o/3)*3;var l=o%3;a.data[o]=n[s]*i[l]+n[s+1]*i[l+3]}a.data[2]+=n[2];a.data[5]+=n[5]},setFromCss:function(e){var t=e.match(/\(([^\)]+)\)/)[1].replace(/\s/g,"").split(",").map(Number);this.data=[t[0],t[1],t[4],t[2],t[3],t[5]]},getCss:function(){var e=this;return"matrix("+e.data[0]+","+e.data[1]+","+e.data[3]+","+e.data[4]+","+e.data[2]+","+e.data[5]+")"}};var TextUtils=new function(){var e=this;e.autosizeTF=function(e,t){var a=undefined;if(e.id)a=Markup.get(e);else a=e.textfield;var r=Markup.getParent(a);t=t||1;var n=undefined;var i=undefined;var o=Styles.getWidth(r);if(Styles.getWidth(a)>o){while(Styles.getWidth(a)>o){n=n===undefined?Styles.getCss(a,"font-size"):n-1;Styles.setCss(a,"font-size",n);i=n*t;Styles.setCss(a,"line-height",i)}}var s=Styles.getHeight(r);if(Styles.getHeight(a)>s){while(Styles.getHeight(a)>s){n=n===undefined?Styles.getCss(a,"font-size"):n-1;Styles.setCss(a,"font-size",n);i=n*t;Styles.setCss(a,"line-height",i)}}if(Styles.getWidth(a)>o||Styles.getHeight(a)>s)TextUtils.autosizeTF(a);else return n?n:Styles.getCss(a,"font-size")};e.fitContainerToText=function(e,t,a){var r=Markup.get(e);if(t){var n=Styles.getWidth(e.textfield);Styles.setCss(e.parent,"width",n);Styles.setCss(e.parent,"left",parseInt(e.textfield.containerData.margin)/2);var i=parseInt(n+parseInt(e.textfield.containerData.margin));Styles.setCss(e.container,"width",i)}else if(a){var o=Styles.getHeight(e.textfield);Styles.setCss(e.parent,"height",o);Styles.setCss(e.container,"height",o)}};e.matchTeamNameSize=function(e,t){var a=TextUtils.autosizeTF(e);var r=TextUtils.autosizeTF(t);var n=a>r?r:a;Styles.setCss(e,{fontSize:n});Align.moveX(Align.CENTER,e);Styles.setCss(t,{fontSize:n});Align.moveX(Align.CENTER,t)};e.addText=function(e,t){var a=typeof e==="string"?Markup.get(e):e;a.innerHTML=t};e.hasText=function(e){var t=typeof e==="string"?Markup.get(e):e;return t.innerHTML.length>0};e.numlines=function(e){var t=typeof e==="string"?Markup.get(e):e;return Styles.getCss(e,"height")/Styles.getCss(e,"line-height")};e.addSpaces=function(e){var t="";for(var a=0;a<e;a++){t+="&nbsp;"}return t};e.getSpecialCharacter=function(t,a){t=global.proxyStringToLowerCase.apply(t);for(var r=0;r<e.specialChars.length;r++){var n=global.proxyStringToLowerCase.apply(e.specialChars[r].label);if(n===t)return a?e.specialChars[r].upperCase:e.specialChars[r].lowerCase}return false};e.specialCharacters=[{label:"iexcl",upperCase:"&#161;",lowerCase:"&#161;"},{label:"trademark",upperCase:"&#153;",lowerCase:"&#153;"},{label:"copyright",upperCase:"&#169;",lowerCase:"&#169;"},{label:"registered",upperCase:"&#174;",lowerCase:"&#174;"},{label:"nTilde",upperCase:"&#209;",lowerCase:"&#241;"},{label:"aAccent",upperCase:"&#193;",lowerCase:"&#225;"},{label:"eAccent",upperCase:"&#201;",lowerCase:"&#233;"},{label:"iAccent",upperCase:"&#205;",lowerCase:"&#237;"},{label:"oAccent",upperCase:"&#211;",lowerCase:"&#243;"},{label:"uAccent",upperCase:"&#218;",lowerCase:"&#250;"}];e.trimStartAndEnd=function(e){return e?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):""};e.removeSpaces=function(e){return e.split(" ").join("")};e.pad=function(e,t){var a="";if(e<0)a="-";e=e.toString().replace(/\-/,"",e);while(e.length<t)e="0"+e;return a+e}};var NetUtils=new function(){this.getQueryParameterBy=function(e){return global.queryParams[e]}};var MathUtils=new function(){var e=this;e.toRadians=function(e){return Math.PI/180*e};e.toDegrees=function(e){return 180/Math.PI*e};e.random=function(e,t,a){t=t||0;a=a!=undefined&&a>0?a:1;var r=Math.min(e,t);var n=Math.max(e,t);r=Math.ceil(r/a)*a;n=Math.floor(n/a)*a;var i=r+Math.floor(Math.random()*((n-r+a)/a))/(1/a);return i};e.randomBoolean=function(e){e=e||.5;return Math.random()<e};e.randomWeightedKey=function(t){var a=[];var r=[0];for(var n in t){a.push(n);r.push(t[n]+(r[r.length-1]||0))}var i=Math.random().toFixed(2)*100;for(var o=0;o<r.length-1;o++){var s=e.inRange(i,r[o],r[o+1]);if(s){return a[o]}}};e.rel=function(e,t,a,r,n){return(n-a)/(r-a)*(t-e)+e};e.inRange=function(e,t,a){var r=Math.min(t,a);var n=Math.max(t,a);return e<=n&&e>=r};e.isNumber=function(e){return!isNaN(e)};e.toNumber=function(e){return+e};e.restrict=function(e,t,a){return Math.max(t,Math.min(a,e))};e.getAnglePoint=function(e,t,a,r){var e=e+Math.cos(r)*a;var t=t+Math.sin(r)*a;return[e,t]};e.getAngle=function(e,t,a,r){a=a||0;r=r||0;return Math.atan2(r-t,a-e)};e.getDistance=function(e,t,a,r){a=a||0;r=r||0;return Math.sqrt((r-t)*(r-t)+(a-e)*(a-e))}};var ObjectUtils=new function(){var e=this;e.objectifier={};e.objectifier.get=function(t,a){a=a||window;var r=e.objectifier._getSplits(t).splits;return e.objectifier._getProperty(r,a)};e.objectifier.set=function(t,a,r){r=r||window;var n=e.objectifier._getSplits(t,true);var i=e.objectifier._getProperty(n.splits,r);i[n.lastKey]=a};e.objectifier._getSplits=function(e,t){var a=e.split(".");var r=t?a.pop():null;return{splits:a,lastKey:r}};e.objectifier._getProperty=function(e,t){var a=t||{};var r;var n;for(r=0;a&&(n=e[r]);r++){a=n in a?a[n]:undefined}return a};e.clone=function(t){if(Object.prototype.toString.call(t)!=="[object Object]"){return t}var a=t.constructor();for(var r in t){a[r]=e.clone(t[r])}return a};e.default=function(t,a,r){t=t||{};var n=e.clone(t);for(var i in a){var o=a[i];if(n[i]===undefined){n[i]=a[i]}else if(r){if(Object.prototype.toString.call(o)==="[object Object]"){n[i]=e.default(n[i],o,r)}}}return n}};function UIBorder(e){var t;var a;var r=new UIDiv(e);Styles.addClass(r,"ui-border");Object.defineProperties(r,{size:{get:function(){return t},set:function(e){if(e!=undefined&&t!=e){t=e;Styles.setCss(r,{borderWidth:t})}}},color:{get:function(){return a},set:function(e){if(e&&a!=e){a=e;Styles.setCss(r,{borderColor:a})}}}});r.toString=function(){return"[object UIBorder]"};Gesture.disable(r);r.color=e.color;r.size=e.size;return r}function UIButton(e){e=e||{};e.css=e.css||{};Styles.injectStylesheet("RED_uiButton",".ui-button","position:absolute",".ui-button-state","position: absolute; width:inherit; height:inherit;");var t=0;var a=[];var r;var n=!!e.containChild;var i=new UIComponent(e);Styles.addClass(i,"ui-button");if(e.bg){s(e.bg,false)}l();e.icon=e.icon||[];for(var o=0;o<e.icon.length;o++){s(e.icon[o],true)}l();i.togglable=e.icon.length>1;Object.defineProperties(i,{bg:{get:function(){return r}},icon:{get:function(){return a}},state:{get:function(){return t},set:function(e){t=e;if(e>=a.length){t=0}for(var r=0;r<a.length;r++){a[r].style.visibility=r==t?"visible":"hidden"}}}});i.onClick=e.onClick||function(e){};i.onOver=e.onOver||function(e){};i.onOut=e.onOut||function(e){};i.toString=function(){return"[object UIButton]"};i._onClick=function(e){};i._onOver=function(e){};i._onOut=function(e){};function s(t,o){var s;var l=e.id+(o?"-state-"+a.length:"-bg");if(typeof t=="string"){s=new UIImage({target:i,id:l,source:t,css:n?{width:"inherit",height:"inherit"}:{}})}else{s=t;s.id=l;i.addChild(s);if(/(UITextField)/gi.exec(s.toString())){s.resetToDefault()}s._initAlign(true)}if(o){a.push(s);Styles.addClass(s,"ui-button-state")}else{r=s}Gesture.disable(s)}function l(){Clamp.set(i,"clamp"+(!e.css.width?"X":"")+(!e.css.height?"Y":""),{},false)}function c(e){if(i.togglable)i.state=Number(!t);i._onClick.call(i,e);i.onClick.call(i,e)}function u(e){i._onOver.call(i,e);i.onOver.call(i,e)}function f(e){i._onOut.call(i,e);i.onOut.call(i,e)}function d(e){var t=i.enabled?"addEventListener":"removeEventListener";Gesture[t](i,GestureEvent.CLICK,c);Gesture[t](i,GestureEvent.OVER,u);Gesture[t](i,GestureEvent.OUT,f)}i.addEventListener(UIEvent.ENABLED,d);i.enabled=true;i.state=e.state||0;i._initAlign();return i}function UISvg(e){e.css=e.css||{};var t=null;var a=e.css||{};var r=1;var n=a.width==undefined;var i=a.height==undefined;if(n&&i){a.width=a.height="inherit"}if(!e.source)throw new Error("UISvg : No markup source set on '"+e.id+"'");var o=new UIComponent(e,"svg");Object.defineProperties(o,{source:{get:function(){return t},set:function(e){t=e;o.innerHTML=e;var a=o.getElementsByTagName("svg")[0];var n=a.getAttribute("viewBox").split(/\s/g);r=+n[2]/+n[3]}},width:{get:function(){return o.offsetWidth},set:function(e){var t=e/r;Styles.setCss(o,{width:e,height:t})}},height:{get:function(){return o.offsetHeight},set:function(e){var t=e*r;Styles.setCss(o,{width:t,height:e})}}});o.toString=function(){return"[object UISvg]"};o.source=e.source;if(n&&i){}else if(n){o.height=a.height}else if(i){o.width=a.width}o._initAlign();return o}var Clamp=function(){var e={x:["offsetWidth","width","left","right"],y:["offsetHeight","height","top","bottom"]};function t(t,a,r,n){var i=Markup.get(t);n=n!==false;var o=i.childNodes;var s=[];var l={};if(/(x)/gi.exec(a))l.x={};if(/(y)/gi.exec(a))l.y={};for(var c=0;c<o.length;c++){var u=o[c];s[c]={};for(var f in l){var d=Styles.getCss(u,f);var g=u[e[f][0]];var v=d+g;var h=l[f];if(c==0){h.min=d;h.max=v}if(d<h.min)h.min=d;if(h.max<v)h.max=v;s[c][f]=d}}var m={top:0,bottom:0,left:0,right:0};if(r){for(var p in m){m[p]=isNaN(r)?r[p]||0:r}}var y={};for(var f in l){var b=l[f];if(n)y[f]=b.min+Styles.getCss(i,f)-m[e[f][2]];y[e[f][1]]=b.max-b.min+m[e[f][2]]+m[e[f][3]]}Styles.setCss(i,y);for(c=0;c<o.length;c++){var u=o[c];var y={};for(var f in l){y[f]=s[c][f]-l[f].min+m[e[f][2]]}Styles.setCss(u,y)}}return{X:"clampX",Y:"clampY",XY:"clampXY",set:t}}();var DateFormatter=new function(){var e=this;e.MS_PER_SECOND=1e3;e.MS_PER_MINUTE=6e4;e.MS_PER_HOUR=36e5;e.MS_PER_DAY=864e5;e.MS_PER_WEEK=6048e5;e.adjust=function(t,a){var r;if(t._isTzDate){r=t.clone()}else{r=new Date(t)}for(var n in a){var i="MS_PER_"+n.toUpperCase();var o=e[i];var s=a[n]*o;r.setTime(r.getTime()+s)}return r};e.getNumericSuffixFor=function(t,a){var t=t.toString();var r=t.slice(t.length-1);var n=e.getLabels();var i=n.TH;switch(r){case"1":if(t!="11")i=n.ST;break;case"2":if(t!="12")i=n.ND;break;case"3":if(t!="13")i=n.RD;break}return(a?t:"")+i};e.format=function(t,a,r){r=r||{};var n=r.inTimezone||t.outputTimezone;var i=r.language;var o=t.getIn(n);var s=e.getLabels(i);var l=o.getMonth();var c=o.getHours();var u=o.getMinutes();var f=a.replace(/\$\{(.*?)\}/g,function(t,a){var r=a;var i=0;var f;var d;var g=false;var v=true;a.replace(/(.+)(\^)/,function(e,t){a=t;g=true});if(a.length==2){a.replace(/(?![Yo])([a-zA-Z]).*?\1/,function(e,t){a=t.substr(0,1);f=2})}switch(a){case"YY":i=-2;case"YYYY":r=(""+o.getFullYear()).slice(i);break;case"M":r=l+1;break;case"MMM":r=s.MONTHS_ABRV[l];break;case"MMMM":r=s.MONTHS_FULL[l];break;case"D":r=o.getDate();break;case"Do":r=e.getNumericSuffixFor(o.getDate(),true);break;case"DDD":r=s.WEEKDAYS_ABRV[o.getDay()];break;case"DDDD":r=s.WEEKDAYS_FULL[o.getDay()];break;case"t":v=u>0;case"T":r=c;if(v){r+=":"+TextUtils.pad(u,2)}break;case"H":r=c;break;case"h":r=c%12;if(r==0){r=12}break;case"m":r=u;break;case"s":r=o.getSeconds();break;case"a":r=c>=12?"pm":"am";break;case"z":r=n.abbr;break}if(f){r=TextUtils.pad(r,f)}if(g){r=r.toUpperCase()}return r});return f};e.language="english";var t={english:{MONTHS_FULL:["January","February","March","April","May","June","July","August","September","October","November","December"],MONTHS_ABRV:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],MONTHS_EXCP:["","","","","","","","","sept","","",""],WEEKDAYS_FULL:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],WEEKDAYS_ABRV:["sun","mon","tue","wed","thu","fri","sat"],WEEKDAYS_EXCP1:["","","tues","wednes","thur","",""],WEEKDAYS_EXCP2:["","","","","thurs","",""],ST:"st",ND:"nd",RD:"rd",TH:"th",OF:"of",TOMORROW:"Tomorrow",TODAY:"Today",TONIGHT:"Tonight",NOW:"Live Now",PAST:"Past"},spanish:{MONTHS_FULL:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],MONTHS_ABRV:["enero","feb","marzo","abr","mayo","jun","jul","agosto","sept","oct","nov","dic"],MONTHS_EXCP:["","","","","","","","","sep","","",""],WEEKDAYS_FULL:["domingo","lunes","martes","mi&#201;rcoles","jueves","viernes","s&#193;bado"],WEEKDAYS_ABRV:["dom","lun","mar","mi&#201;r","jue","vier","s&#193;b"],WEEKDAYS_EXCP1:["","","tues","wednes","thur","",""],WEEKDAYS_EXCP2:["","","","","thurs","",""],ST:"ro",ND:"ndo",RD:"rd",TH:"th",OF:"de",TOMORROW:"ma&#209;ana",TODAY:"hoy",TONIGHT:"esta noche",NOW:"en vivo",PAST:"past"}};e.monthsFull="MONTHS_FULL";e.monthsAbrv="MONTHS_ABRV";e.weekdaysFull="WEEKDAYS_FULL";e.weekdaysAbrv="WEEKDAYS_ABRV";e.getLabels=function(a){return t[a||e.language]}};var DateManager=new function(){var e=this;var t;e.init=function(e){var a=NetUtils.getQueryParameterBy("date");var r="SYSTEM-DATE";Timezone.LOCAL;if(a){t=a;r="EXTERNAL-DATE"}else if(e.dateOverride&&(adParams.environmentId=="staging"||adParams.environmentId=="debug")){t=e.dateOverride();r="INTERNAL-DATE"}if(t){var n=new TzDate({datetime:t});var i=n.outputTimezone;var o=NetUtils.getQueryParameterBy("tz");if(o){i.label=i.abbr=o}Timezone.LOCAL=i}var s=NetUtils.getQueryParameterBy("ltz");if(s){adParams.defaultTimezone=s}if(s){}if(e.language){DateFormatter.language=e.language}};e.getNow=function(){var e=t;if(e==undefined){e=(new Date).toISOString().split(".")[0]+"+00:00"}return new TzDate({datetime:e,outputTimezone:Timezone.LOCAL})};e.isPast=function(t,a){if(a==undefined){a=e.getNow()}return a.getTime()>=t.getTime()};e.getTimeDifference=function(e,t){var a=t.getTime()/1e3-e.getTime()/1e3;if(a<0){a=0}var r={day:a/(24*60*60),hour:a/(60*60)%24,minute:a/60%60,second:a%60,output:""};var n=["day","hour","minute","second"];for(var i=0;i<4;i++){r.output+=TextUtils.pad(Math.floor(r[n[i]]),2);if(i<3)r.output+=":"}return r}};var Timezone=new function(){var e=this;var t=["LOCAL","UTC","EST","CST","MST","PST","AKST","AZ","HST","MEX","AEST","AEST2"];var a;e._trueLOCAL;e._tzDiff=[0,0,0];Object.defineProperties(e,{LOCAL:{get:function(){if(a==undefined){var t=new Date;var r=e.getDLS(t);var n=-(t.getTimezoneOffset()/60)-r;a={label:"Local",abbr:"local",value:n};var i=e.get(a.value);if(isNaN(i)){a.label=i.label;a.abbr=i.abbr}else{var o=t.toTimeString();var s=o.split("(")[1];s=s.substr(0,s.length-1);s=s.replace(/[a-z\.\s]/g,"");a.label=a.abbr=s}e._trueLOCAL=a}return a},set:function(t){var r=new Date;var n=r.getTimezoneOffset();var i=Math.floor(n/60);var o=n%60;var s=Math.floor(t.value);var l=t.value%1*60;var c=-(s+i);var u=-(l+o);var f=Timezone.getDLS(r);if(t.value==0){f=0}else if(t.value>0){c=24+c}e._tzDiff[0]=c-f;e._tzDiff[1]=u;a=t}},UTC:{get:function(){return{label:"UTC",abbr:"utc",value:0}}},EST:{get:function(){return{label:"US/Eastern",abbr:"et",value:-5}}},CST:{get:function(){return{label:"US/Central",abbr:"ct",value:-6}}},MST:{get:function(){return{label:"US/Mountain",abbr:"mt",value:-7}}},PST:{get:function(){return{label:"US/Pacific",abbr:"pt",value:-8}}},AKST:{get:function(){return{label:"US/Alaska",abbr:"akst",value:-9}}},AZ:{get:function(){return{label:"US/Arizona",abbr:"az",value:-7}}},HST:{get:function(){return{label:"US/Hawaii",abbr:"hst",value:-10}}},MEX:{get:function(){return{label:"America/Mexico_City",abbr:"mx",value:-6}}},AEST:{get:function(){return{label:"Australia/Brisbane",abbr:"aest",value:10}}},AEST2:{get:function(){return{label:"Australia/Sydney",abbr:"aest",value:10}}}});e.get=function(a){if(a==undefined)return e.LOCAL;if(typeof a==="string"){for(var r=0;r<t.length;r++){if(e[t[r]].label==a){return e[t[r]]}}return null}else if(typeof a==="number"&&isFinite(a)){for(var r=0;r<t.length;r++){if(e[t[r]].value===a){if(e[t[r]].label!="Local"){return e[t[r]]}}}return{label:"Local",abbr:"Local",value:a}}else{return a}};e.getDLS=function(e){var t=new Date("2011","01","01");var a=new Date("2011","07","01");var r=t.getTimezoneOffset();var n=a.getTimezoneOffset();var i=e.getTimezoneOffset();return i==n&&i!=r?1:0}};function TzDate(e){e=e||{};var t;var a=e.datetime;if(Array.isArray(a)){a=e.datetime[0];t=e.datetime[1]}if(typeof a==="string"){a=a.replace(/(\T|\s)/g,"T");var r=a.match(/(\+|\-)([0-9]{2})\:([0-9]{2})/g);if(r){r=r[0];if(r=="+00:00"){t=Timezone.UTC}else{var n=Timezone.getDLS(new Date(a));var i=c(r,n);t=Timezone.get(i)}}else{if(t){t=Timezone.get(t);var o=Timezone.getDLS(new Date(a));a+=l(t,o)}}}if(e.outputTimezone){t=Timezone.get(e.outputTimezone)}else if(adParams.defaultTimezone){t=Timezone.get(adParams.defaultTimezone)}var s=new Date(a);Object.defineProperties(s,{outputTimezone:{get:function(){return t||Timezone.UTC},set:function(e){t=Timezone.get(e)}}});s.clone=function(e){e=e||s.outputTimezone;return new TzDate({datetime:s,outputTimezone:e})};s.getHoursIn=function(e,t){var a=s.getIn(e);var r=a.getHours();if(t!=true&&r>12){r=r%12}return r};s.format=function(e,t){return DateFormatter.format(s,e,t)};s.getIn=function(e){var t=s.toISOString().split(".")[0];var a=Timezone.getDLS(s);var r=l(Timezone._trueLOCAL,a);var n=Timezone.get(e||s.outputTimezone);var i=new Date(t+r);var o=Timezone.getDLS(i);if(n.label==Timezone.UTC.label){o=0}return DateFormatter.adjust(i,{hour:n.value+o})};s.print=function(e){var t=s.toFullDateTime(e);return t};s.toFullDateTime=function(e){e=e||s.outputTimezone;var t=s.getIn(e);var a=t.toString().split("GMT")[0]+e.label;return a};s.toSimpleDate=function(e){var t=s.getIn(e);return t.getMonth()+1+"/"+t.getDate()};s.toDate=function(e){var t=s.getIn(e);return s.toSimpleDate(e)+"/"+t.getFullYear()};s.toDateTime=function(e){return s.toDate(e)+" "+s.toTime(e)};s.toSimpleDateTime=function(){return s.toSimpleDate()+" "+s.toTime()};s.toTime=function(e){return s.toSimpleTime(e)+" "+s.toMeridiem(e)};s.toSimpleTime=function(e,t){var a=s.getIn(e);var r=s.getHoursIn(e,t);if(r==0){r=12}if(t){r=TextUtils.pad(r,2)}return r+":"+TextUtils.pad(a.getMinutes(),2)};s.toMeridiem=function(e,t){var a=e||s.outputTimezone;var r=s.getIn(a);return(r.getHours()>=12?"pm":"am")+(t==true?"/"+a.abbr:"")};s.toShortestTime=function(e,t){var a=s.toSimpleTime(e,t);var r=a.replace(/:00$/g,"");return r};s.toDateTimeISO=function(e){var t=s.toDate(e);var a=t.split("/");var r=a[2];var n=TextUtils.pad(a[0],2);var i=TextUtils.pad(a[1],2);var o=s.toSimpleTime(e,true);return r+"-"+n+"-"+i+"T"+o+":00"};s._isTzDate=true;function l(e,t){var a=e.value+t;var r=a>0?Math.floor(a):Math.ceil(a);var n=a%1*60;n=a>0?Math.floor(n):Math.ceil(n);var i=a<0?"-":"+";return i+TextUtils.pad(Math.abs(r),2)+":"+TextUtils.pad(Math.abs(n),2)}function c(e,t){var a=e.split(":");var r=+a[0];var n=+a[1]/60;return r+n-t}return s}var Velvet=new function(){var e=this;var t="https://json.ff0000-cdn.net/";var a="https://preview.ff0000-cdn.net/preview/";var r;var n;var i;var o;var s=false;e.adDataRaw={};e.init=function(s,u){i=u;if(e.isPreviewLocation()){r=a}else{r=t}o=s;n=o.client+"/"+o.locale+"/";var f=getQueryParams();if(f.addata){o.addata=f.addata}o.addata?c():l()};e.get=function(){var t=typeof arguments[0]==="string";var a=arguments[t?0:1];var r=t?e.adDataRaw:arguments[0];var n=!!arguments[t?1:2];var i=[];var o=a.replace(/\.value(\.|)/g,".").replace(/\.$/,"");var s=o.split(".");var l;var c=s.pop();var u="";for(var f=0;f<s.length;f++){if(f>0)u+=".";u+=s[f];if(isNaN(s[f])){u+=".value"}}var d=s.length>0;if(d){s=u.split(".");l=s.shift();s.push(c)}function g(e){switch(Object.prototype.toString.call(e)){case"[object Object]":v(e);break;case"[object Array]":h(e);break}}function v(e){for(var t in e){p(e,t)}}function h(e){if(!d&&!isNaN(c)){i.push(e[c])}else{for(var t=0;t<e.length;t++){v(e[t])}}}function m(e){return e.hasOwnProperty("value")?e.value:e}function p(e,t){if(t==c&&!d){i.push(m(e[t]))}else if(t==l){var a=y(s,e[t]);if(a){i.push(m(a))}return}if(n){g(e[t])}}function y(e,t){var a=t||{};var r;var n;for(r=0;a&&(n=e[r]);r++){a=n in a?a[n]:undefined}return a}g(r);if(i.length==1){i=i[0]}else if(i.length==0){i=undefined}return i};e.isPreviewLocation=function(){var e=window.location.href;if(e==undefined||e==null)return false;var t=getQueryParams();if(t["velvet"]==="production")return false;else if(t["velvet"]==="preview")return true;if(e.match(/^file/)||adParams.environmentId=="staging"||adParams.environmentId=="default"||e.match(/manta\.joyent\.com/)||e.match(/ff0000\.com/)||e.match(/adprodtest/)||e.match(/client\-projects\.com/)||e.match(/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+:[0-9]+/))return true;return false};function l(){new DataLoader(r+n+o.segment,{name:"segmentLoader",fileType:"json",onComplete:u,onFail:global.failAd}).load()}function c(){new DataLoader(r+n+o.addata,{name:"velvetAdDataLoader",fileType:"json",onComplete:f,onFail:global.failAd}).load()}function u(e){var t=JSON.parse(e.dataRaw);adParams.defaultTimezone=t.tz;if(adParams.defaultTimezone){}var a=t.timeblocks;var r=DateManager.getNow();for(var n=0;n<a.length;n++){var i=a[n].time;if(r<i){break}}var s=n-1;if(s<0){global.failAd();return}else{}var l=a[s].ad_rotation;o.addata=MathUtils.randomWeightedKey(l);c()}function f(t){e.adDataRaw=JSON.parse(t.dataRaw);i.call(e)}};var PrepareCommon=new function(){var e="PrepareCommon";var t=this;var a;t.completeCallback;t.init=function(e){t.completeCallback=e;a=new Async;a.onComplete(t.initComplete);a.wait();r();n();a.done()};function r(){DateManager.init(adParams.dateSettings)}function n(){a.wait();Velvet.init(adParams.velvet,i)}function i(){a.done()}t.initComplete=function(){a=new Async;a.onComplete(t.completeCallback);a.wait();t.prepareAdData();t.loadImageQueue();a.done()};t.prepareAdData=function(){global.adData=new AdData;global.ftData=new FtData};t.loadImageQueue=function(){a.wait();ImageManager.load(t.loadImageQueueComplete,t.loadImageQueueFail)};t.loadImageQueueFail=function(){global.failAd()};t.loadImageQueueComplete=function(){a.done()}};function AdData(){var e=this;setVelvetAdName(adParams);var t=Velvet.get("url");if(typeof clickTag==="string"){clickTag=t}else if(Array.isArray(clickTag)){clickTag.push(t)}var a;if(!Velvet.isPreviewLocation()&&(adParams.appleNewsSize==="900x750"||adParams.appleNewsSize==="1242x332"||adParams.appleNewsSize==="1242x699"||adParams.appleNewsSize==="2208x699"||adParams.appleNewsSize==="2208x212")&&(a=document.getElementById("anchor"))){e.usingAnchor=true;if(a||!adParams.nytApp){a.href=clickTag}}e.elements={};e.elements.redAdContainer=Markup.get("redAdContainer");e.elements.redMainContainer=Markup.get("redMainContainer");e.primaryColors={msnbcBlue:"#0063cf",white:"#ffffff",black:"#000000",darkGrey:"#1c1c1c"};e.fonts={reg:"NeueHaasGrotesk-Regular",med:"NeueHaasGrotesk-Semibold",semibold:"NeueHaasGrotesk-Semibold"};e.obj3D={backfaceVisibility:"hidden",transformStyle:"preserve-3d",transformPerspective:500,force3D:true};var r=Velvet.get("category.animation_color")||e.primaryColors.msnbcBlue;e.categoryColor=r;var n=Velvet.get("story");n=Array.isArray(n)?n:[n];function i(e){for(var t=0;t<e.length;t++){StaticGenerator.addInfo({story:t,label:"TWITTER"})}StaticGenerator.dispatchData()}if(adParams.adWidth===1024&&adParams.adHeight===576){i(n)}e.stories=selectStories(n);e.velvetGet=function(t){switch(t){case"category_color":return e.categoryColor;case"cta":if(isDevEnvironment()){}var a=Velvet.get(t);return a&&a.toUpperCase();default:return Velvet.get(t)}};e.coverageText=e.velvetGet("subhead")||"BREAKING NEWS";e.ctaText=e.velvetGet("cta")||"WATCH LIVE NOW";e.onEndFrame=false}function getStoryValueId(e,t){return"story."+e+"."+t}function getStoryValue(e,t){var a=getStoryValueId(e,t);return Velvet.get(a)}function getSizeSpecificIfAny(e){var t=adParams.appleNewsSize||adParams.adSize;var a=e.sizes[t];var r=false;if(a&&typeof a==="object"){r=!Object.keys(a).length}var n=false;if(typeof a==="string"){n=!a.length}return a!==undefined&&a!==null&&!r&&!n?a:e.value}function getImageIfAny(e){if(shouldLoadImages()){var t=Device.product==="iphone"||Device.product==="android"||adParams.appleNewsSize||adParams.adWidth===1024&&adParams.adHeight===576||adParams.adWidth===970&&adParams.adHeight===250?"mobile_img":"image";var a=Velvet.get(e,t);if(!a)return;var r=a.sizes?getSizeSpecificIfAny(a):a&&a.mobile_img&&a.mobile_img.value;var n=r&&r.url;return n&&ImageManager.addToLoad(n)}return undefined}function getStory(e){var t=getStoryValue(e,"subhead");t=t&&t.toUpperCase();var a=getStoryValueId(e,"image");var r=Velvet.get(a);var n=getStoryValue(e,"headline");var i=getSizeSpecificIfAny(n);var o={headline:i,coverage:t||"BREAKING NEWS",image:getImageIfAny(r)};return o}function getTwitterStory(){var e=Velvet.get("story.subhead");e=e&&e.toUpperCase();return{headline:Velvet.get("story.headline"),coverage:e||"BREAKING NEWS",image:getImageIfAny("story.image")}}function selectStories(e){if(!Array.isArray(Velvet.get("story"))){return[getTwitterStory()]}var t=e.length;var a=[];var r=NetUtils.getQueryParameterBy("story");if(r&&e[+r]){a.push(getStory(+r))}else{for(var n=0;n<t;n++){a.push(getStory(n))}}return a}function shouldLoadImages(){return adParams.adWidth!==320||adParams.adHeight!==50}function prepareMultiStory(e){var t=e.Base;var a=e.ImageView;var r=e.NoImageView;var n=e.stories;var i=e.baseConfig;var o=e.imageStoryConfig;var s=e.noImageStoryConfig;CSSPlugin.defaultForce3D=true;var l=i();View=new t(l);View.MainBlock=View.buildMainBlock();View.EndFrame=View.buildEndFrame(l);View.Stories=n.map(function(e,t){var n=e.image?o():s();n=objectAssign(n,{target:View.MainBlock,isFirst:t===0,story:e});var i=e.image?a:r;var l=new i(n);return l});View.Border=View.buildBorder();View.Clicker=View.buildClicker();View.hideLaterElems();View.Stories.forEach(function(e){e.hideLaterElems()})}function objectAssign(){function e(e){return Array.prototype.slice.call(e,1)}var t=arguments[0];var a=arguments[arguments.length-1];var r=typeof a==="boolean"?a:false;function n(e,t){Object.keys(t).forEach(function(a){var i=t[a];if(r&&isObject(e[a])&&isObject(i)){n(e[a],i,true)}else{e[a]=i}});return e}var i=e(arguments);return i.reduce(n,t)}function isObject(e){return e&&JSON.stringify(e.constructor())==="{}"}function force3DAnim(e,t,a,r){Styles.setCss(t,{rotationZ:.01});return e(t,a,objectAssign(r,{force3D:true,transformStyle:"preserve-3d",transformPerspective:1e3}))}function normalizeValsForSize(e,t){var a=ObjectUtils.clone(t);for(var r in a){if(r==="ctaTextToContentRatio"){continue}var n=a[r];if(n&&n.toString()==="[object Object]"){a[r]=normalizeValsForSize(e,a[r])}else if(!isNaN(n)&&typeof n==="number"){a[r]=e*a[r];if(r==="dotSize"){a[r]=Math.round(a[r])}}}return a}function CtaButton(e){var t=e.primaryColor||"red";var a=e.secondaryColor||"white";var r=e.ctaFontSize;var n=e.ctaTextYShift;var i=e.ctaArrowXShift;var o=e.ctaArrowYShift;var s=e.ctaContentsWidth;var l=e.ctaContentsHeight;var c=e.format||TextFormat.INLINE_FIT_CLAMP;var u=e.ctaTextToContentRatio||function(){return.9}();var f={css:{color:a},alignText:Align.CENTER,fontSize:r};f=ObjectUtils.default(e,f,true);var d={backgroundColor:t,width:f.css.width,height:f.css.height};if(f.css.x){d.x=e.css.x;delete f.css.x}if(f.css.y){d.y=e.css.y;delete f.css.y}var g=f.align;delete f.align;var v=new UIButton({target:e.target,id:"ctacta",css:d,bg:new UIComponent({css:{width:"100%",height:"100%",backgroundColor:a,transformOrigin:"0% 0%",scaleX:0}}),align:g,onOver:function(){C()},onOut:function(){}});v.contents=new UIComponent({id:"contents",target:v,css:{width:s,height:l},align:Align.CENTER});v.text=new UITextField({target:v.contents,fontSize:r,fontFamily:e.fontFamily,css:{width:s*u,height:l,color:a},text:e.text,align:{x:Align.LEFT,y:Align.CENTER},format:c});console.log("ctaContentsWidth",s);console.log("ctaContentsWidth * textToContentRatio",s*u);console.log("C.text.offsetWidth",v.text.offsetWidth);function h(e,t){return adParams.adWidth===e&&adParams.adHeight===t}function m(){if(h(2208,699)||h(900,750)){return 1}return 0}var p=v.text.querySelector("span").getBoundingClientRect().height;v.arrow=new UISvg({id:"arrow",target:v.contents,css:{height:p},align:{x:Align.RIGHT,y:{type:Align.CENTER,offset:m()}},source:'<svg viewBox="0 0 5 7" style="position:absolute;">'+'<path d="m0,6.47767l2.73087,-3.07104l-2.73087,-3.01435l1.99382,0l2.73087,3.01435l-2.73087,3.07104l-1.99382,0z" fill="'+a+'" class="svg_cta_arrow"></path>'+"</svg>"});v.arrow.startX=v.arrow.x+i;v.isOver=false;var y=v.text.getBoundingClientRect().left;var b=y+v.text.width;var w=v.arrow.x-b;Align.set(v.text,{x:{type:Align.LEFT,against:(y+w)/2-s*.025},y:Align.CENTER});n&&Styles.setCss(v.text,{y:n});i&&TweenLite.set(v.arrow,{x:"+="+i});o&&TweenLite.set(v.arrow,{y:"+="+o});function C(){var e=.5;var t=Quad.easeInOut;var a=d.width/64;TweenLite.to(v.arrow,e,{ease:t,force3D:true,transformStyle:"preserve-3d",transformPerspective:1e3,rotationZ:.01,x:v.arrow.startX+a,onComplete:function(){TweenLite.to(v.arrow,e,{ease:t,force3D:true,transformStyle:"preserve-3d",transformPerspective:1e3,rotationZ:.01,x:v.arrow.startX,onComplete:function(){if(v.isOver)C()}})}})}v.over=function(e){v.isOver=true;v._onOver.call(v,e);v.onOver.call(v,e)};v.out=function(e){v.isOver=false;v._onOut.call(v,e);v.onOut.call(v,e)};v.enabled=e.enabled!=false;return v}function introAnim(e,t){var a=t.delay;var r=t.onComplete;var n=t.slideTime;var i=t.fadeTime;o({delay:a,horizSlide:t.horizSlide});function o(t){t=t||{};var a=t.delay||0;var r=t.horizSlide?{x:-adParams.adWidth}:{y:-adParams.adHeight};var i=ObjectUtils.default({delay:a,onComplete:s},r);force3DAnim(TweenLite.from,e.MainBlock.bg,n*1.3,i)}function s(){force3DAnim(TweenLite.to,e.MainBlock.logo,i,{alpha:0,onComplete:r})}}function objectAssign(){function e(e){return Array.prototype.slice.call(e,1)}var t=arguments[0];var a=arguments[arguments.length-1];var r=typeof a==="boolean"?a:false;function n(e,t){Object.keys(t).forEach(function(a){var i=t[a];if(r&&isObject(e[a])&&isObject(i)){n(e[a],i,true)}else{e[a]=i}});return e}var i=e(arguments);return i.reduce(n,t)}function isObject(e){return e&&JSON.stringify(e.constructor())==="{}"}function force3DAnim(e,t,a,r){Styles.setCss(t,{rotationZ:.01});return e(t,a,objectAssign(r,{force3D:true,transformStyle:"preserve-3d",transformPerspective:1e3}))}function normalizeValsForSize(e,t){var a=ObjectUtils.clone(t);for(var r in a){if(r==="ctaTextToContentRatio"){continue}var n=a[r];if(n&&n.toString()==="[object Object]"){a[r]=normalizeValsForSize(e,a[r])}else if(!isNaN(n)&&typeof n==="number"){a[r]=e*a[r];if(r==="dotSize"){a[r]=Math.round(a[r])}}}return a}function startScene(){var e=animParams.delayBetweenStories;var t=View.Stories.slice(1).map(function(t,a,r){var n=r[a-1];var i=n&&n.hide;return[t.startAnim,{delay:e,hideLastStory:i}]});var a=[View.startAnim,View.Stories[0].startAnim,View.bringInCtaAndLogo].concat(t).concat(Control.animationComplete);var r=createAnimSeq(a);r()}var animParams=function(){var e=.5;return{slideTime:e,fadeTime:.5,blockSlideTime:e*.5,delayBetweenStories:2.5}}();function animateLongImageView(e,t){var a=animParams.slideTime;var r=animParams.fadeTime;var n=animParams.blockSlideTime;e._slideStoryIn=function(){e.show();force3DAnim(TweenLite.from,e,a*1.3,{x:-adParams.adWidth,onComplete:function(){t.hideLastStory&&t.hideLastStory();e._slideImageIn()}})};e._slideImageIn=function(){force3DAnim(TweenLite.from,e.image,n,{x:"-="+.3*e.image.width});force3DAnim(TweenLite.to,e.imageClip,n,{onComplete:e._bringInCoverage,clip:t.createClipWithX(0)})};e._bringInCoverage=function(){e.coverage.show();force3DAnim(TweenLite.from,e.coverage,a,{y:-e.coverage.height,onComplete:function(){e._slowImageScaleLoop();e._blinkDot();e._bringInLine()}})};e._slowImageScaleLoop=function(){var t=13;var a=1.1;function r(a,r){return function(){TweenLite.set(e.image,{rotation:.01});TweenLite.to(e.image,t,{scale:a,ease:Power1.easeInOut,onComplete:r,force3D:false,transformOrigin:"center"})}}var n=r(1);var i=r(a,n);return i()};e._blinkDot=function(t,a,r){t=t===undefined?true:t;a=a||Date.now();r=r||Date.now();var n=15*1e3;var i=r-a;var o=1;function s(){if(!t)return true;var e=n-i;var a=o*1e3;var r=a;return e>r}Styles.setCss(e.coverageDot,{opacity:Number(t)});s()&&TweenLite.delayedCall(o,function(){e._blinkDot(!t,a,Date.now())})};e._bringInLine=function(){e.line.show();force3DAnim(TweenLite.from,e.line,r,{height:0,onComplete:e._bringInHeadline})};e._bringInHeadline=function(){e.headline.show();force3DAnim(TweenLite.from,e.headlineText,r,{x:"-="+e.headlineText.width,alpha:0,onComplete:t.onComplete})};var i=e.isFirst?e._slideImageIn:e._slideStoryIn;TweenLite.delayedCall(t.delay,i);return e}function animateLongNoImageView(e,t){var a=animParams.slideTime;var r=animParams.fadeTime;var n=animParams.blockSlideTime;e._slideStoryIn=function(){e.show();force3DAnim(TweenLite.from,e,a*1.3,{x:-adParams.adWidth,onComplete:function(){t.hideLastStory&&t.hideLastStory();e._bringInCoverage()}})};e._bringInCoverage=function(){e.coverage.show();TweenLite.from(e.coverage,r,{alpha:0,onComplete:function(){e._blinkDot();e._bringInLine()}})};e._blinkDot=function(t,a,r){t=t===undefined?true:t;a=a||Date.now();r=r||Date.now();var n=15*1e3;var i=r-a;var o=1;function s(){if(!t)return true;var e=n-i;var a=o*1e3;var r=a;return e>r}Styles.setCss(e.coverageDot,{opacity:Number(t)});s()&&TweenLite.delayedCall(o,function(){e._blinkDot(!t,a,Date.now())})};e._bringInLine=function(){e.line.show();force3DAnim(TweenLite.from,e.line,r,{height:0,onComplete:e._bringInHeadline})};e._bringInHeadline=function(){e.headline.show();force3DAnim(TweenLite.from,e.headlineText,r,{x:"-="+e.headlineText.width,alpha:0,onComplete:t.onComplete})};var i=e.isFirst?e._bringInCoverage:e._slideStoryIn;TweenLite.delayedCall(t.delay,i);return e}var createAnimSeq=function(){function e(e){return e.slice(0,-1)}function t(e){if(Array.isArray(e)){return{fn:e[0],args:e[1]}}else{return{fn:e,args:{}}}}return function(a,r){if(!a.length){return r}else if(a.length>=1){var n=t(a[a.length-1]);var i=ObjectUtils.default({onComplete:r},n.args);var o=function(){return n.fn(i)};return createAnimSeq(e(a),o)}}}();var LongBase=function(){Styles.setCss(adData.elements.redAdContainer,{backgroundColor:adData.primaryColors.darkGrey});this.buildMainBlock=function(){var e=new UIComponent({target:adData.elements.redAdContainer,id:"intro",css:{width:"100%",height:"100%",backgroundColor:adData.primaryColors.darkGrey}});e.bg=new UIComponent({target:e,id:"intro",css:{width:"100%",height:"100%",backgroundColor:adData.velvetGet("category_color")}});return e};this.buildEndFrame=function(e){var t=new UIComponent({target:adData.elements.redAdContainer,id:"endframe",css:{width:"100%",height:"100%"}});t.logo=new UIImage({id:"endframe_logo",target:t,source:"logo",css:{x:e.logoX,y:e.logoY,width:e.logoWidth,height:e.logoHeight}});var a=adData.ctaText;t.cta=new CtaButton({target:t,id:"endframe_cta",primaryColor:adData.primaryColors.white,secondaryColor:adData.categoryColor,css:{width:e.ctaWidth,height:e.ctaHeight},fontFamily:adData.fonts.semibold,enabled:false,align:{x:{type:Align.LEFT,against:t.logo,outer:true,offset:-e.ctaLogoOffset},y:{type:Align.BOTTOM,against:t.logo}},text:a,ctaContentsWidth:e.ctaContentsWidth,ctaContentsHeight:e.ctaContentsHeight,ctaFontSize:e.ctaFontSize,ctaTextYShift:e.ctaTextYShift,ctaTextToContentRatio:e.ctaTextToContentRatio});t.ctaBorder=new UIBorder({target:t.cta,size:1,color:adData.primaryColors.white});return t};this.buildClicker=function(){var e=new UIDiv({id:"clicker",target:adData.elements.redAdContainer,css:{width:"inherit",height:"inherit",zIndex:10}},adData.usingAnchor?"a":"div");if(adData.usingAnchor){adData.elements.redMainContainer.style.zIndex="-1";if(!adParams.nytApp){e.href=clickTag}}else{Gesture.addEventListener(e,GestureEvent.CLICK,function(e){Control.handleClick(e)})}Gesture.addEventListener(e,GestureEvent.OVER,function(){if(adData.onEndFrame)View.EndFrame.cta.over()});Gesture.addEventListener(e,GestureEvent.OUT,function(){if(adData.onEndFrame)View.EndFrame.cta.out()})};this.buildBorder=function(){new UIBorder({id:"intro",target:adData.elements.redAdContainer,size:1,color:"#000000"})};this.hideLaterElems=function(){View.EndFrame.logo.hide();View.EndFrame.cta.hide()};var e=animParams.slideTime;var t=animParams.fadeTime;var a=animParams.blockSlideTime;this.startAnim=function(a){a=a||{};introAnim(this,{delay:.5,onComplete:a.onComplete,slideTime:e,fadeTime:t,horizSlide:true})};this.startAnim=this.startAnim.bind(this);this.bringInCtaAndLogo=function(e){e=e||{};a();function a(){View.EndFrame.logo.show();TweenLite.from(View.EndFrame.logo,t,{alpha:0,onComplete:r})}function r(){adData.onEndFrame=true;View.EndFrame.cta.show();TweenLite.from(View.EndFrame.cta,t,{x:"-=50",alpha:0,onComplete:e.onComplete})}};this.bringInCtaAndLogo=this.bringInCtaAndLogo.bind(this)};var LongImageView=function(e){var t=new UIComponent({target:e.target,css:{width:"100%",height:"100%",backgroundColor:!e.isFirst&&adData.velvetGet("category_color")}});t.isFirst=e.isFirst;var a=e.imgHeight||adParams.adHeight;var r=e.imgWidth||a*16/9;var n=e.extraClip||0;var i=r-n;var o=makeClipCreatorWithChangingX(e.imgY,i,a);var s=e.story.image;t.imageClip=new UIComponent({id:"img_clip",target:t,css:{x:e.imgX,y:e.imgY,width:r,height:a,clip:o(-r)}});t.image=new UIImage({id:"img",target:t.imageClip,css:{x:e.imgX,y:e.imgY,width:r,height:a},source:s});var l={width:e.headlineWidth,height:e.headlineHeight};var c=5;var u=e.headlineLineDiff!==undefined?e.headlineLineDiff:4;t.line=new UIComponent({target:t,css:objectAssign({},l,{backgroundColor:adData.primaryColors.white,x:e.lineX,y:e.lineY,height:l.height-u,width:1})});t.headline=new UIComponent({target:t,css:{width:l.width,height:l.height+c,clip:"rect(0, "+l.width+"px,"+l.height+c+"px,0)"},align:{x:{type:Align.RIGHT,against:t.line,outer:true,offset:e.headlineXOffset},y:{type:Align.CENTER,against:t.line}}});t.headlineText=new UITextField({target:t.headline,id:"headline",fontSize:e.headlineFontSize,fontFamily:adData.fonts.reg,format:TextFormat.PARAGRAPH_FIT_CLAMP,css:{width:l.width,height:l.height,color:"white"},align:{y:Align.CENTER},text:e.story.headline});Clamp.set(t.headline,Clamp.XY);t=e.addCoverage(t,e);t.hideLaterElems=function(){t.coverage.hide();t.line.hide();t.headline.hide()};t.startAnim=function(e){var a=ObjectUtils.default({createClipWithX:o},e||{});animateLongImageView(t,a)};!t.isFirst&&t.hide();return t};function createClipRect(e,t,a,r){return"rect("+t+"px "+(e+a)+"px "+(t+r)+"px "+e+"px)"}function makeClipCreatorWithChangingX(e,t,a){return function(r){return createClipRect(r,e,t,a)}}var LongNoImageView=function(e){var t=new UIComponent({target:e.target,css:{width:"100%",height:"100%",backgroundColor:!e.isFirst&&adData.velvetGet("category_color")}});t.isFirst=e.isFirst;var a={width:e.headlineWidth,height:e.headlineHeight};var r=5;t.line=new UIComponent({target:t,css:{backgroundColor:adData.primaryColors.white,x:e.lineX,y:e.lineY,width:1,height:e.lineHeight}});t.headline=new UIComponent({target:t,css:{width:a.width,height:a.height+r,clip:"rect(0, "+a.width+"px,"+a.height+r+10+"px,0)"},align:{x:{type:Align.RIGHT,against:t.line,outer:true,offset:e.headlineXOffset},y:{type:Align.CENTER,against:t.line}}});t.headlineText=new UITextField({target:t.headline,id:"headline",fontSize:e.headlineFontSize,fontFamily:adData.fonts.reg,format:TextFormat.PARAGRAPH_FIT_CLAMP,css:{width:a.width,height:a.height,color:"white"},align:{y:Align.CENTER},text:e.story.headline});Clamp.set(t.headline,Clamp.XY);t.coverageText=new UITextField({target:t,text:e.story.coverage,spacing:e.coverageSpacing,fontSize:e.coverageFontSize,fontFamily:adData.fonts.med,css:{color:adData.primaryColors.white,x:e.coverageX,y:e.coverageY,width:e.coverageWidth,height:e.coverageHeight},format:TextFormat.INLINE_CLAMP,align:Align.TOP_LEFT,alignText:Align.RIGHT});t.coverageDot=new UIImage({target:t,id:"red_dot",source:"red_dot_outline",css:{width:e.dotSize,height:e.dotSize},align:{x:{type:Align.CENTER,against:t.line},y:{type:Align.CENTER,against:t.coverageText,offset:e.coverageDotYOffset}}});t.coverage=new UIGroup({id:"coverage",target:t,children:[t.coverageText,t.coverageDot]});t.hideLaterElems=function(){t.coverage.hide();t.line.hide();t.headline.hide()};t.startAnim=function(e){var a=ObjectUtils.default({},e||{});animateLongNoImageView(t,a)};!t.isFirst&&t.hide();return t};function addCornerCoverage(e,t){var a={width:t.coverageWidth,height:t.coverageHeight};e.coverage=new UIComponent({id:"coverage",target:e,css:ObjectUtils.default(a,{backgroundColor:"rgba(0, 0, 0, 0.5)"}),format:TextFormat.INLINE_FIT_CLAMP,align:Align.TOP_LEFT});e.coverageText=new UITextField({target:e.coverage,text:t.story.coverage,fontSize:100,fontFamily:adData.fonts.med,css:{width:"inherit",height:"inherit",color:adData.primaryColors.white},format:TextFormat.INLINE_FIT,align:Align.TOP_LEFT,alignText:Align.RIGHT,spacing:t.coverageSpacing});e.coverageDot=new UIImage({target:e.coverage,id:"red_dot",source:"red_dot",css:{x:t.dotX,y:t.dotY,width:t.dotSize,height:t.dotSize}});var r=e.coverageText.querySelector("span");r.style.width="";function n(e){return e.x+e.width}var i=n(e.coverageDot);var o=n(e.coverage);var s=t.getCoverageTextYFix?t.getCoverageTextYFix(t.story.coverage):0;Align.set(r,{x:{type:Align.CENTER,offset:t.coverageTextXOffset,against:(i+o)/2},y:{type:Align.CENTER,offset:t.coverageTextYOffset+s}});var l=t.coverageTextWidth/r.offsetWidth;var c=Device.product==="pc";if(c){function u(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)}function f(e){var t=/^(\d+)px$/.exec(d);var a=t[1];return+a}var d=u(r,"font-size");var g=f(d);var v=+g+1+"px";r.style.fontSize=v;Styles.setCss(e.coverage,"padding-right","5px")}Styles.setCss(r,{transform:"scaleX("+l+") scaleY("+l+")"});var h=r.offsetHeight;var m=r.style.display;r.style.height=null;r.style.display="inline-block";if(t.coverageTextHeight&&r.offsetHeight>t.coverageTextHeight){var p=t.coverageTextHeight/r.offsetHeight;if(p<l){Styles.setCss(r,{transform:"scaleX("+p+") scaleY("+p+")"})}}r.style.height=h+"px";r.style.display=m;return e}function FtData(){this.validateImagePath=function(e){if(e==""||e.indexOf("null")>-1||e.indexOf("ftBlankGif")>-1)return null;else return e};this.getImage=function(e,t){var a;if(myFT.instantAds[e])a=myFT.instantAds[e];else if(e in this.imageMap){if(t in this.imageMap[e])a=adParams.adPath+this.imageMap[e][t];else a=adParams.adPath+this.imageMap[e]["default"]}if(a)return this.validateImagePath(a)}}function setVelvetAdName(e){var t=e.velvet;e.redAnalytics.adName=[t.segment,t.adData].join(":")}var ViewStyles={};var Views={};var Control=new function(){this.prepareBuild=function(){Control.preMarkup();prepareMultiStory({Base:LongBase,baseConfig:baseConfig,ImageView:LongImageView,imageStoryConfig:imageStoryConfig,NoImageView:LongNoImageView,noImageStoryConfig:noImageStoryConfig,stories:adData.stories});Control.postMarkup();Animation.startAd();Animation.startScene()};this.preMarkup=function(){};this.postMarkup=function(){if(adParams.redAnalytics){trackImpression(adParams.redAnalytics.stages.ANIMATION)}};this.handleClick=function(e){if(adParams.redAnalytics){trackExit(e)}Network.exit(clickTag)};this.animationComplete=function(){if(adParams.redAnalytics){trackImpression(adParams.redAnalytics.stages.COMPLETE)}}};var View={};var Animation=new function(){this.startAd=function(){View.MainBlock.logo=document.getElementById("preloader").querySelector("img");View.MainBlock.appendChild(View.MainBlock.logo);global.removePreloader();Styles.setCss(global.adData.elements.redAdContainer,{opacity:1})};this.startScene=function(){startScene()}};var baseConfig=function(){function e(e){if(e.product==="pc"&&e.browser==="firefox"){return 0}var t={edge:-1,firefox:1};return t[e.browser]||t.chrome}var t=35;var a=42;var r=a/t;var n=165;var i=n*r;function o(e,t){return Math.abs(e/t-adParams.adWidth/adParams.adHeight)<.001}var s={isMobile:true,ctaWidth:i,ctaHeight:a,ctaFontSize:20,ctaContentsWidth:143*r,ctaContentsHeight:12*r*1.2,ctaTextToContentRatio:function(){if(Device.browser==="chrome"){return.9}else if(Device.browser==="safari"){return.8}else if(Device.browser==="firefox"){return.9}return 1}(),ctaLogoOffset:28,logoWidth:200*r,logoHeight:35*r,logoX:1016-(i-n),logoY:232-(a-t)};var l=adParams.adHeight;var c=300;var u=l/c;var f=normalizeValsForSize(u,s);var d=1242/300*adParams.adHeight-adParams.adWidth;f.logoX-=d;f.logoX-=28;return f};var imageStoryConfig=function(){function e(e){return window.innerWidth>=414?e:e*375/414}var t=0;if(Device.browser==="safari"&&Device.os==="osx"){t=-1}var a={isMobile:true,addCoverage:addCornerCoverage,imgX:0,imgY:0,headlineWidth:e(500),headlineHeight:e(80),lineX:560,lineY:62,headlineXOffset:e(15),headlineFontSize:66,coverageWidth:202,coverageHeight:42,coverageTextWidth:150,coverageTextHeight:20,coverageTextXOffset:-2,coverageTextYOffset:t,dotSize:15,dotX:14,dotY:13};var r=adParams.adHeight;var n=300;var i=r/n;var o=normalizeValsForSize(i,a);return o};var noImageStoryConfig=function(){var e={isMobile:true,lineX:34,lineY:97,lineHeight:100,headlineWidth:600,headlineHeight:100,headlineXOffset:15,headlineFontSize:100,coverageX:53,coverageY:52,coverageWidth:144,coverageHeight:13,coverageFontSize:18,coverageDotYOffset:Device.product==="pc"&&Device.browser==="firefox"?1:0,dotSize:16};var t=adParams.adHeight;var a=300;var r=t/a;var n=normalizeValsForSize(r,e);return n};